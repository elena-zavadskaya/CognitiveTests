import{_ as b,a as v,r as c,c as n,o as a,b as f,d as e,t as i,e as h,g as m,F as p,f as S,w as y,u as k}from"./index.js";/* empty css                                              */const P={components:{Navbar:v},setup(){return{authStore:k()}},data(){return{cups:[0,1,2],ballPosition:0,gameStarted:!1,gameEnded:!1,gameWon:!1,round:1,maxRounds:5,message:"",showBall:!1,isSelectable:!1,startTime:null,time:0,accuracy:0}},methods:{startGame(){this.resetGame(),this.startTime=new Date,this.startRound()},resetGame(){this.gameStarted=!0,this.gameEnded=!1,this.gameWon=!1,this.round=1,this.message=""},startRound(){this.message=`Раунд ${this.round}. Следите за шариком!`,this.ballPosition=Math.floor(Math.random()*3),this.showBall=!0,this.isSelectable=!1,setTimeout(()=>{this.shuffleCups()},1e3)},shuffleCups(){let s=0;const t=5+this.round*2,r=setInterval(()=>{this.ballPosition=this.getRandomPosition(),s++,s>=t&&(clearInterval(r),this.showBall=!0,setTimeout(()=>{this.showBall=!1,this.isSelectable=!0,this.message="Выберите стаканчик!"},100))},500-this.round*50)},getRandomPosition(){let s;do s=Math.floor(Math.random()*3);while(s===this.ballPosition);return s},selectCup(s){this.isSelectable&&(this.isSelectable=!1,s===this.ballPosition?(this.message="Правильно!",this.round<this.maxRounds?(this.round++,setTimeout(()=>this.startRound(),2e3)):this.endGame(!0)):(this.message=`Неправильно! Шарик был под стаканчиком ${this.ballPosition+1}.`,this.endGame(!1)))},endGame(s){this.gameEnded=!0,this.gameStarted=!1,this.gameWon=s;const t=new Date;this.time=((t-this.startTime)/1e3).toFixed(2),this.accuracy=s?100:Math.round((this.round-1)/this.maxRounds*100),this.saveResults()},async saveResults(){if(!this.authStore.user){alert("Пользователь не авторизован. Пожалуйста, войдите в систему.");return}const s=9,t=this.accuracy;try{const r=await fetch("http://127.0.0.1:8000/api/result/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({test:s,user:this.authStore.user.id,score_percentage:parseFloat(t)})});if(r.ok)alert("Результаты успешно сохранены!");else{const d=await r.json();alert(d.error||"Ошибка при сохранении результатов")}}catch(r){console.error("Ошибка при отправке результатов:",r)}}}},w={class:"container mt-5 text-center"},C={id:"app"},R={key:0},T={key:1},x={class:"info"},B={class:"cups-container"},G=["onClick"],N={key:0,class:"ball"},E={class:"message"},I={key:2,class:"end-message"},M={key:0},W={key:1};function D(s,t,r,d,o,u){const g=c("Navbar"),_=c("router-link");return a(),n(p,null,[f(g),e("div",w,[e("h2",null,i(s.$route.params.name),1),e("div",C,[!o.gameStarted&&!o.gameEnded?(a(),n("div",R,[t[1]||(t[1]=e("h1",null,'Игра-тренажер: "Наперстки"',-1)),t[2]||(t[2]=e("p",null,[e("strong",null,'"Наперстки"'),m(" — это увлекательная игра, направленная на развитие внимания и памяти. ")],-1)),t[3]||(t[3]=e("p",null,[e("strong",null,"Цель игры:"),m(" Найти, под каким стаканчиком находится шарик после перемешивания. Сложность увеличивается с каждым раундом. ")],-1)),t[4]||(t[4]=e("p",null," Игра помогает развивать концентрацию, тренировать зрительное внимание и улучшать кратковременную память. Удачи! ",-1)),e("button",{class:"start-button btn btn-primary",onClick:t[0]||(t[0]=(...l)=>u.startGame&&u.startGame(...l))},"Начать игру")])):o.gameStarted?(a(),n("div",T,[e("div",x,[e("p",null,"Раунд: "+i(o.round)+" / "+i(o.maxRounds),1)]),e("div",B,[(a(!0),n(p,null,S(o.cups,l=>(a(),n("div",{key:l,class:"cup",onClick:F=>u.selectCup(l)},[l===o.ballPosition&&o.showBall?(a(),n("div",N)):h("",!0)],8,G))),128))]),e("div",E,i(o.message),1)])):h("",!0),o.gameEnded?(a(),n("div",I,[e("h3",null,i(o.gameWon?"Поздравляем!":"Игра окончена!"),1),o.gameWon?(a(),n("div",M,t[5]||(t[5]=[e("p",null,'Вы успешно прошли игру "Наперстки"!',-1),e("p",null,"Вы продемонстрировали прекрасное внимание и память.",-1)]))):(a(),n("div",W,[e("p",null,"Шарик был под стаканчиком "+i(o.ballPosition+1)+". Попробуйте снова!",1)])),e("p",null,"Точность: "+i(o.accuracy)+"%",1),e("p",null,"Время прохождения игры: "+i(o.time)+" секунд",1)])):h("",!0),f(_,{to:"/tests",class:"btn btn-secondary mt-3"},{default:y(()=>t[6]||(t[6]=[m("Назад к тестам")])),_:1})])])],64)}const A=b(P,[["render",D]]);export{A as default};
