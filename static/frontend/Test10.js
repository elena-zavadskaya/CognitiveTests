import{_ as S,a as b,r as h,c as l,o as c,b as p,d as s,t as a,e as g,g as u,F as v,f as k,n as _,w as E,u as C}from"./index.js";/* empty css                                              */const M={components:{Navbar:b},setup(){return{authStore:C()}},data(){return{tiles:[],moves:0,timeElapsed:0,accuracy:100,timer:null,gameStarted:!1,gameEnded:!1,endMessage:""}},computed:{time(){const e=Math.floor(this.timeElapsed/60).toString().padStart(2,"0"),t=(this.timeElapsed%60).toString().padStart(2,"0");return`${e}:${t}`},motivationalMessage(){return this.moves<=50?"Феноменальный результат! Вы прирождённый стратег!":this.moves<=150?"Отличная работа! Вы проявили аналитическое мышление.":this.moves<=300?"Хорошо! Немного практики, и результат улучшится.":"Вы сделали это! Продолжайте тренироваться для улучшения навыков."}},methods:{startGame(){clearInterval(this.timer),this.timeElapsed=0,this.moves=0,this.tiles=this.initializeTiles(),this.gameStarted=!0,this.gameEnded=!1,this.timer=setInterval(()=>{this.timeElapsed++},1e3)},initializeTiles(){const e=[...Array(15).keys()].map(t=>(t+1).toString());return e.push(""),this.shuffleTiles(e)},shuffleTiles(e){for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e},moveTile(e){const t=this.tiles.indexOf("");[t-1,t+1,t-4,t+4].includes(e)&&([this.tiles[t],this.tiles[e]]=[this.tiles[e],this.tiles[t]],this.moves++,this.accuracy=this.calculateAccuracy())},testVictory(){const e=[...Array(15).keys()].map(t=>(t+1).toString()).concat("");this.tiles.join("")===e.join("")?this.endGame("Поздравляем! Вы выиграли!"):this.endGame("Игра еще не окончена. Продолжайте!")},endGame(e){clearInterval(this.timer),this.gameEnded=!0,this.endMessage=e,this.accuracy=this.calculateAccuracy(),this.saveResults()},calculateAccuracy(){const e=[...Array(15).keys()].map(r=>(r+1).toString()).concat("");let t=0;for(let r=0;r<this.tiles.length;r++)this.tiles[r]===e[r]&&t++;return(t/15*100).toFixed(2)},async saveResults(){if(!this.authStore.user){alert("Пользователь не авторизован. Пожалуйста, войдите в систему.");return}const e=10,t=parseInt(this.accuracy);try{const r=await fetch("http://127.0.0.1:8000/api/result/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({test:e,user:this.authStore.user.id,score_percentage:t})});if(r.ok)alert("Результаты успешно сохранены!");else{const m=await r.json();alert(m.error||"Ошибка при сохранении результатов")}}catch(r){console.error("Ошибка при отправке результатов:",r)}}},beforeDestroy(){clearInterval(this.timer)}},T={class:"container mt-5 text-center"},A={id:"app"},I={key:0},N={key:1},V={class:"game-board grid"},x=["onClick"],G={key:2,class:"end-message"};function j(e,t,r,m,n,i){const f=h("Navbar"),y=h("router-link");return c(),l(v,null,[p(f),s("div",T,[s("h2",null,a(e.$route.params.name),1),s("div",A,[!n.gameStarted&&!n.gameEnded?(c(),l("div",I,[t[2]||(t[2]=s("h1",null,'Логическая игра "Пятнашки"',-1)),t[3]||(t[3]=s("p",null,[s("strong",null,'"Пятнашки"'),u(" — это головоломка 4x4, состоящая из 15 костяшек и одной пустой клетки. ")],-1)),t[4]||(t[4]=s("p",null,[s("strong",null,"Цель игры:"),u(" упорядочить костяшки по возрастанию, начиная с левого верхнего угла. ")],-1)),t[5]||(t[5]=s("p",null," Тренируйте критическое мышление и стратегическое планирование, решая головоломку за минимальное количество ходов! ",-1)),s("button",{class:"start-button btn btn-primary",onClick:t[0]||(t[0]=(...o)=>i.startGame&&i.startGame(...o))},"Начать игру")])):n.gameStarted?(c(),l("div",N,[s("p",null,"Прошедшее время: "+a(i.time),1),s("p",null,"Ходы: "+a(n.moves),1),s("div",V,[(c(!0),l(v,null,k(n.tiles,(o,d)=>(c(),l("button",{key:d,class:_(["tile",o===""?"empty":""]),onClick:O=>i.moveTile(d)},a(o),11,x))),128))]),s("button",{class:"btn btn-danger mt-3",onClick:t[1]||(t[1]=(...o)=>i.testVictory&&i.testVictory(...o))},"Проверить победу")])):g("",!0),n.gameEnded?(c(),l("div",G,[t[6]||(t[6]=s("h3",null,"Игра завершена!",-1)),s("p",null,a(n.endMessage),1),s("p",null,"Количество ходов: "+a(n.moves),1),s("p",null,"Время прохождения: "+a(i.time),1),s("p",null,"Точность: "+a(n.accuracy)+"%",1),s("p",null,a(i.motivationalMessage),1)])):g("",!0),p(y,{to:"/tests",class:"btn btn-secondary"},{default:E(()=>t[7]||(t[7]=[u("Назад к тестам")])),_:1})])])],64)}const B=S(M,[["render",j]]);export{B as default};
