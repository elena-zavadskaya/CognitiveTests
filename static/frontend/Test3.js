import{_ as Q,a as S,r as m,c as u,o as a,b as d,d as e,t as o,e as p,F as T,f as w,g as x,w as _,u as b}from"./index.js";const g={components:{Navbar:S},setup(){return{authStore:b()}},data(){return{currentView:"start",currentQuestionIndex:0,score:0,missClicks:0,timer:0,totalTime:0,hardestQuestionIndex:null,hardestQuestionTime:0,questionStartTime:0,questionStartGlobalTime:0,errorQuestions:[],questions:[{text:"Найдите лишнее:",options:["Таращиться","Наблюдать","Моргать","Глазеть","Смотреть"],correct:"Моргать"},{text:"Найди лишнее:",options:["Клоун","Акробат","Шут","Канатоходец"],correct:"Акробат"},{text:"Найди лишнее:",options:["Июнь","Март","Май","Июль"],correct:"Март"},{text:"Найди лишнее:",options:["Превосходный","Поэтичный","Величественный","Грандиозный"],correct:"Поэтичный"},{text:"Найди лишнее:",options:["Хлопок","Шерсть","Шелк","Лён","Эластан"],correct:"Эластан"},{text:"Найди лишнее:",options:["Самолёт","Машина","Птица","Ракета","Бабочка"],correct:"Машина"},{text:"Найди лишнее:",options:["Жёлтый","Синий","Зелёный"],correct:"Жёлтый"},{text:"Найди лишнее:",options:["2","6","7","4"],correct:"7"},{text:"Найди лишнее:",options:["Радар","Заказ","Кабак","Топор"],correct:"Топор"},{text:"Найди лишнее:",options:["Сельдерей","Огурец","Авокадо","Киви"],correct:"Киви"}]}},computed:{currentQuestion(){return this.questions[this.currentQuestionIndex]},accuracy(){const n=this.questions.length;return(this.score/n*100).toFixed(2)}},methods:{startTest(){this.currentView="test",this.currentQuestionIndex=0,this.score=0,this.missClicks=0,this.timer=0,this.totalTime=0,this.hardestQuestionIndex=null,this.hardestQuestionTime=0,this.errorQuestions=[],this.questionStartGlobalTime=performance.now(),this.questionStartTime=performance.now(),this.startTimer()},startTimer(){this.timerInterval=setInterval(()=>{this.timer=performance.now()-this.questionStartGlobalTime},10)},stopTimer(){clearInterval(this.timerInterval)},checkAnswer(n){const t=this.currentQuestion.options[n],i=(performance.now()-this.questionStartTime)/1e3;t===this.currentQuestion.correct?this.score++:(this.missClicks++,this.errorQuestions.push(this.currentQuestionIndex+1)),i>this.hardestQuestionTime&&(this.hardestQuestionTime=i,this.hardestQuestionIndex=this.currentQuestionIndex),this.currentQuestionIndex<this.questions.length-1?(this.currentQuestionIndex++,this.questionStartTime=performance.now()):this.endTest()},endTest(){this.stopTimer(),this.totalTime=performance.now()-this.questionStartGlobalTime,this.currentView="result",this.saveResults()},formatTime(n){const t=Math.floor(n/1e3),i=Math.floor(t/60),l=t%60,s=Math.floor(n%1e3);return`${String(i).padStart(2,"0")}:${String(l).padStart(2,"0")}.${String(s).padStart(3,"0")}`},restartTest(){this.startTest()},goBack(){this.currentView="start"},async saveResults(){if(!this.authStore.user){alert("Пользователь не авторизован. Пожалуйста, войдите в систему.");return}const n=3,t=this.accuracy;try{const i=await fetch("http://127.0.0.1:8000/api/result/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({test:n,user:this.authStore.user.id,score_percentage:parseFloat(t)})});if(i.ok)alert("Результаты успешно сохранены!");else{const l=await i.json();alert(l.error||"Ошибка при сохранении результатов")}}catch(i){console.error("Ошибка при отправке результатов:",i)}}}},v={class:"container mt-5 text-center"},I={id:"app"},C={key:0},y={key:1},q={class:"horizontal-options"},V=["onClick"],N={class:"controls"},B={key:2},A={key:0};function F(n,t,i,l,s,r){const f=m("Navbar"),k=m("router-link");return a(),u(T,null,[d(f),e("div",v,[e("h2",null,o(n.$route.params.name),1),e("div",I,[s.currentView==="start"?(a(),u("div",C,[t[4]||(t[4]=e("h1",null,"Проверка на быстроту реакции и сообразительность",-1)),e("button",{id:"start-button",onClick:t[0]||(t[0]=(...c)=>r.startTest&&r.startTest(...c))},"Начать тест")])):s.currentView==="test"?(a(),u("div",y,[e("h2",null,"Вопрос "+o(s.currentQuestionIndex+1),1),e("p",null,o(r.currentQuestion.text),1),e("ul",q,[(a(!0),u(T,null,w(r.currentQuestion.options,(c,h)=>(a(),u("button",{key:h,onClick:G=>r.checkAnswer(h)},o(c),9,V))),128))]),e("p",null,"Ошибки: "+o(s.missClicks),1),e("p",null,"Время: "+o(r.formatTime(s.timer)),1),e("div",N,[e("button",{onClick:t[1]||(t[1]=(...c)=>r.endTest&&r.endTest(...c)),id:"text"},"Завершить тест")])])):s.currentView==="result"?(a(),u("div",B,[t[5]||(t[5]=e("h1",null,"Результаты теста",-1)),e("p",null,"Правильных ответов: "+o(s.score)+" из "+o(s.questions.length),1),e("p",null,[x("Ошибок: "+o(s.missClicks)+" ",1),s.missClicks>0?(a(),u("span",A," (Вопросы: "+o(s.errorQuestions.join(", "))+")",1)):p("",!0)]),e("p",null,"Общее время: "+o(r.formatTime(s.totalTime)),1),e("p",null,"Точность: "+o(r.accuracy)+"%",1),e("p",null,"Самый сложный вопрос: Вопрос №"+o(s.hardestQuestionIndex+1)+" (время: "+o(s.hardestQuestionTime.toFixed(3))+" сек)",1),e("button",{onClick:t[2]||(t[2]=(...c)=>r.restartTest&&r.restartTest(...c)),id:"text"},"Пройти заново"),e("button",{onClick:t[3]||(t[3]=(...c)=>r.goBack&&r.goBack(...c)),id:"text"},"Вернуться назад")])):p("",!0)]),d(k,{to:"/tests",class:"btn btn-secondary"},{default:_(()=>t[6]||(t[6]=[x("Назад к тестам")])),_:1})])],64)}const O=Q(g,[["render",F]]);export{O as default};
