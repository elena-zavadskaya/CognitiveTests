import{_ as g,a as w,r as d,c as o,o as i,b as _,d as s,t as n,e as c,g as m,F as f,f as S,w as v,u as y}from"./index-BFI9Nzsh.js";/* empty css                                                       */const k={components:{Navbar:w},setup(){return{authStore:y()}},data(){return{cups:[0,1,2],ballPosition:0,gameStarted:!1,gameEnded:!1,gameWon:!1,round:1,number_all_answers:5,number_correct_answers:0,message:"",showBall:!1,isSelectable:!1,startTime:null,time:0}},computed:{accuracy(){if(this.number_all_answers===0)return 0;const t=this.number_correct_answers/this.number_all_answers*100;return Number(t.toFixed(2))},formattedTime(){const t=String(Math.floor(this.time/3600)).padStart(2,"0"),e=String(Math.floor(this.time%3600/60)).padStart(2,"0"),a=String(this.time%60).padStart(2,"0");return`${t}:${e}:${a}`}},methods:{startGame(){this.resetGame(),this.startTime=Date.now(),this.startRound()},resetGame(){this.gameStarted=!0,this.gameEnded=!1,this.gameWon=!1,this.round=1,this.number_correct_answers=0,this.message=""},startRound(){this.message=`Раунд ${this.round}. Следите за шариком!`,this.ballPosition=Math.floor(Math.random()*3),this.showBall=!0,this.isSelectable=!1,setTimeout(()=>{this.shuffleCups()},1e3)},shuffleCups(){let t=0;const e=5+this.round*2,a=setInterval(()=>{this.ballPosition=this.getRandomPosition(),t++,t>=e&&(clearInterval(a),this.showBall=!0,setTimeout(()=>{this.showBall=!1,this.isSelectable=!0,this.message="Выберите стаканчик!"},100))},500-this.round*50)},getRandomPosition(){let t;do t=Math.floor(Math.random()*3);while(t===this.ballPosition);return t},selectCup(t){this.isSelectable&&(this.isSelectable=!1,t===this.ballPosition?(this.message="Правильно!",this.number_correct_answers++,this.round<this.number_all_answers?(this.round++,setTimeout(()=>this.startRound(),2e3)):this.endGame(!0)):(this.message=`Неправильно! Шарик был под стаканчиком ${this.ballPosition+1}.`,this.endGame(!1)))},endGame(t){this.gameEnded=!0,this.gameStarted=!1,this.gameWon=t,this.time=Math.floor((Date.now()-this.startTime)/1e3),this.saveResults()},async saveResults(){if(!this.authStore.user){alert("Пользователь не авторизован.");return}const e={test:9,user:this.authStore.user.id,score_percentage:Math.round(this.accuracy),time:this.formattedTime,number_all_answers:this.number_all_answers,number_correct_answers:this.number_correct_answers,accuracy:Math.round(this.accuracy)};console.log("Отправляемые данные:",e);try{const a=await fetch("http://127.0.0.1:8000/api/result/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(e)}),h=await a.json();if(!a.ok)throw new Error(h.detail||h.error||`Ошибка ${a.status}`);alert("Результаты успешно сохранены!")}catch(a){console.error("Ошибка сохранения:",a),alert(`Ошибка: ${a.message}`)}}}},C={class:"container mt-5 text-center"},T={id:"app"},P={key:0},B={key:1},M={class:"info"},N={class:"cups-container"},G=["onClick"],E={key:0,class:"ball"},R={class:"message"},I={key:2,class:"end-message"};function x(t,e,a,h,r,u){const p=d("Navbar"),b=d("router-link");return i(),o(f,null,[_(p),s("div",C,[s("h2",null,n(t.$route.params.name),1),s("div",T,[!r.gameStarted&&!r.gameEnded?(i(),o("div",P,[e[1]||(e[1]=s("h1",null,'Игра-тренажер: "Наперстки"',-1)),e[2]||(e[2]=s("p",null,[s("strong",null,'"Наперстки"'),m(" — это увлекательная игра, направленная на развитие внимания и памяти. ")],-1)),e[3]||(e[3]=s("p",null,[s("strong",null,"Цель игры:"),m(" Найти, под каким стаканчиком находится шарик после перемешивания. Сложность увеличивается с каждым раундом. ")],-1)),s("button",{class:"start-button btn btn-primary",onClick:e[0]||(e[0]=(...l)=>u.startGame&&u.startGame(...l))},"Начать игру")])):r.gameStarted?(i(),o("div",B,[s("div",M,[s("p",null,"Раунд: "+n(r.round)+" / "+n(r.number_all_answers),1)]),s("div",N,[(i(!0),o(f,null,S(r.cups,l=>(i(),o("div",{key:l,class:"cup",onClick:V=>u.selectCup(l)},[l===r.ballPosition&&r.showBall?(i(),o("div",E)):c("",!0)],8,G))),128))]),s("div",R,n(r.message),1)])):c("",!0),r.gameEnded?(i(),o("div",I,[s("h3",null,n(r.gameWon?"Поздравляем!":"Игра окончена!"),1),s("p",null,"Правильных ответов: "+n(r.number_correct_answers)+" из "+n(r.number_all_answers),1),s("p",null,"Точность: "+n(u.accuracy)+"%",1),s("p",null,"Время прохождения игры: "+n(r.time),1)])):c("",!0),_(b,{to:"/tests",class:"btn btn-secondary mt-3"},{default:v(()=>e[4]||(e[4]=[m("Назад к тестам")])),_:1})])])],64)}const F=g(k,[["render",x]]);export{F as default};
