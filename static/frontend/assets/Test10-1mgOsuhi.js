import{_ as b,a as v,r as d,c as l,o as c,b as _,d as s,t as n,e as p,g as m,F as g,f as w,n as S,w as k,u as T}from"./index-BFI9Nzsh.js";/* empty css                                                       */const M={components:{Navbar:v},setup(){return{authStore:T()}},data(){return{tiles:[],moves:0,timeElapsed:0,timer:null,gameStarted:!1,gameEnded:!1,endMessage:"",number_all_answers:15,number_correct_answers:0,startTime:null}},computed:{accuracy(){if(this.number_all_answers===0)return 0;const e=this.number_correct_answers/this.number_all_answers*100;return Number(e.toFixed(2))},time(){const e=String(Math.floor(this.timeElapsed/3600)).padStart(2,"0"),t=String(Math.floor(this.timeElapsed%3600/60)).padStart(2,"0"),r=String(this.timeElapsed%60).padStart(2,"0");return`${e}:${t}:${r}`},motivationalMessage(){return this.accuracy>=95?"Феноменальный результат! Вы прирождённый стратег!":this.accuracy>=85?"Отличная работа! Вы проявили аналитическое мышление.":this.accuracy>=70?"Хорошо! Немного практики, и результат улучшится.":this.accuracy>=50?"Попробуйте улучшить результат!":"Продолжайте тренироваться для улучшения навыков."}},methods:{startGame(){clearInterval(this.timer),this.timeElapsed=0,this.moves=0,this.tiles=this.initializeTiles(),this.gameStarted=!0,this.gameEnded=!1,this.number_correct_answers=0,this.startTime=Date.now(),this.timer=setInterval(()=>{this.timeElapsed=Math.floor((Date.now()-this.startTime)/1e3)},1e3)},initializeTiles(){const e=[...Array(15).keys()].map(t=>(t+1).toString());return e.push(""),this.shuffleTiles(e)},shuffleTiles(e){for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e},moveTile(e){const t=this.tiles.indexOf("");[t-1,t+1,t-4,t+4].includes(e)&&([this.tiles[t],this.tiles[e]]=[this.tiles[e],this.tiles[t]],this.moves++,this.number_correct_answers=this.calculateCorrectTiles())},testVictory(){const e=[...Array(15).keys()].map(t=>(t+1).toString()).concat("");this.tiles.join("")===e.join("")?this.endGame("Поздравляем! Вы выиграли!"):this.endGame("Игра еще не окончена. Продолжайте!")},endGame(e){clearInterval(this.timer),this.gameEnded=!0,this.endMessage=e,this.number_correct_answers=this.calculateCorrectTiles(),this.saveResults()},calculateCorrectTiles(){const e=[...Array(15).keys()].map(t=>(t+1).toString()).concat("");return this.tiles.filter((t,r)=>t===e[r]).length},async saveResults(){if(!this.authStore.user){alert("Пользователь не авторизован. Пожалуйста, войдите в систему.");return}const t={test:10,user:this.authStore.user.id,score_percentage:Math.round(this.accuracy),time:this.time,number_all_answers:this.number_all_answers,number_correct_answers:this.number_correct_answers,accuracy:Math.round(this.accuracy)};console.log("Отправляемые данные:",t);try{const r=await fetch("http://127.0.0.1:8000/api/result/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(t)}),u=await r.json();if(!r.ok)throw new Error(u.detail||u.error||`Ошибка ${r.status}`);alert("Результаты успешно сохранены!")}catch(r){console.error("Ошибка сохранения:",r),alert(`Ошибка: ${r.message}`)}}},beforeUnmount(){clearInterval(this.timer)}},E={class:"container mt-5 text-center"},C={id:"app"},N={key:0},I={key:1},V={class:"game-board grid"},x=["onClick"],G={key:2,class:"end-message"};function j(e,t,r,u,a,i){const f=d("Navbar"),y=d("router-link");return c(),l(g,null,[_(f),s("div",E,[s("h2",null,n(e.$route.params.name),1),s("div",C,[!a.gameStarted&&!a.gameEnded?(c(),l("div",N,[t[2]||(t[2]=s("h1",null,'Логическая игра "Пятнашки"',-1)),t[3]||(t[3]=s("p",null,[s("strong",null,'"Пятнашки"'),m(" — это головоломка 4x4, состоящая из 15 костяшек и одной пустой клетки. ")],-1)),t[4]||(t[4]=s("p",null,[s("strong",null,"Цель игры:"),m(" упорядочить костяшки по возрастанию, начиная с левого верхнего угла. ")],-1)),s("button",{class:"start-button btn btn-primary",onClick:t[0]||(t[0]=(...o)=>i.startGame&&i.startGame(...o))},"Начать игру")])):a.gameStarted?(c(),l("div",I,[s("p",null,"Прошедшее время: "+n(i.time),1),s("p",null,"Ходы: "+n(a.moves),1),s("div",V,[(c(!0),l(g,null,w(a.tiles,(o,h)=>(c(),l("button",{key:h,class:S(["tile",o===""?"empty":""]),onClick:A=>i.moveTile(h)},n(o),11,x))),128))]),s("button",{class:"btn btn-danger mt-3",onClick:t[1]||(t[1]=(...o)=>i.testVictory&&i.testVictory(...o))},"Проверить победу")])):p("",!0),a.gameEnded?(c(),l("div",G,[t[5]||(t[5]=s("h3",null,"Игра завершена!",-1)),s("p",null,n(a.endMessage),1),s("p",null,"Правильно расположенных плиток: "+n(a.number_correct_answers)+" из "+n(a.number_all_answers),1),s("p",null,"Количество ходов: "+n(a.moves),1),s("p",null,"Время прохождения: "+n(i.time),1),s("p",null,"Точность: "+n(i.accuracy)+"%",1),s("p",null,n(i.motivationalMessage),1)])):p("",!0),_(y,{to:"/tests",class:"btn btn-secondary"},{default:k(()=>t[6]||(t[6]=[m("Назад к тестам")])),_:1})])])],64)}const B=b(M,[["render",j]]);export{B as default};
