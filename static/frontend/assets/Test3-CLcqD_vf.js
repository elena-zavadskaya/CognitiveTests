import{_ as x,a as f,r as m,c as u,o as c,b as d,d as e,t as n,e as _,F as p,f as k,g as T,w as Q,u as S}from"./index-BFI9Nzsh.js";const I={components:{Navbar:f},setup(){return{authStore:S()}},data(){return{currentView:"start",currentQuestionIndex:0,missClicks:0,timer:0,totalTime:0,hardestQuestionIndex:null,hardestQuestionTime:0,questionStartTime:0,questionStartGlobalTime:0,errorQuestions:[],number_all_answers:0,number_correct_answers:0,questions:[{text:"Найдите лишнее:",options:["Таращиться","Наблюдать","Моргать","Глазеть","Смотреть"],correct:"Моргать"},{text:"Найди лишнее:",options:["Клоун","Акробат","Шут","Канатоходец"],correct:"Акробат"},{text:"Найди лишнее:",options:["Июнь","Март","Май","Июль"],correct:"Март"},{text:"Найди лишнее:",options:["Превосходный","Поэтичный","Величественный","Грандиозный"],correct:"Поэтичный"},{text:"Найди лишнее:",options:["Хлопок","Шерсть","Шелк","Лён","Эластан"],correct:"Эластан"},{text:"Найди лишнее:",options:["Самолёт","Машина","Птица","Ракета","Бабочка"],correct:"Машина"},{text:"Найди лишнее:",options:["Жёлтый","Синий","Зелёный"],correct:"Жёлтый"},{text:"Найди лишнее:",options:["2","6","7","4"],correct:"7"},{text:"Найди лишнее:",options:["Радар","Заказ","Кабак","Топор"],correct:"Топор"},{text:"Найди лишнее:",options:["Сельдерей","Огурец","Авокадо","Киви"],correct:"Киви"}]}},computed:{currentQuestion(){return this.questions[this.currentQuestionIndex]},accuracy(){return this.number_all_answers===0?0:(this.number_correct_answers/this.number_all_answers*100).toFixed(2)}},methods:{startTest(){this.currentView="test",this.currentQuestionIndex=0,this.missClicks=0,this.timer=0,this.totalTime=0,this.hardestQuestionIndex=null,this.hardestQuestionTime=0,this.errorQuestions=[],this.questionStartGlobalTime=performance.now(),this.questionStartTime=performance.now(),this.number_all_answers=this.questions.length,this.number_correct_answers=0,this.startTimer()},startTimer(){this.timerInterval=setInterval(()=>{this.timer=performance.now()-this.questionStartGlobalTime},10)},stopTimer(){clearInterval(this.timerInterval)},checkAnswer(i){const t=this.currentQuestion.options[i],o=(performance.now()-this.questionStartTime)/1e3;t===this.currentQuestion.correct?this.number_correct_answers++:(this.missClicks++,this.errorQuestions.push(this.currentQuestionIndex+1)),o>this.hardestQuestionTime&&(this.hardestQuestionTime=o,this.hardestQuestionIndex=this.currentQuestionIndex),this.currentQuestionIndex<this.questions.length-1?(this.currentQuestionIndex++,this.questionStartTime=performance.now()):this.endTest()},endTest(){this.stopTimer(),this.totalTime=performance.now()-this.questionStartGlobalTime,this.currentView="result",this.saveResults()},formatTime(i){const t=Math.floor(i/1e3),o=Math.floor(t/3600),l=Math.floor(t%3600/60),s=t%60;return`${String(o).padStart(2,"0")}:${String(l).padStart(2,"0")}.${String(s).padStart(2,"0")}`},restartTest(){this.startTest()},goBack(){this.currentView="start"},async saveResults(){if(!this.authStore.user){alert("Пользователь не авторизован. Пожалуйста, войдите в систему.");return}const i=3,t=parseFloat(this.accuracy);try{const o=await fetch("http://127.0.0.1:8000/api/result/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({test:i,user:this.authStore.user.id,score_percentage:parseInt(t,10),time:this.formatTime(this.totalTime),number_correct_answers:this.number_correct_answers,number_all_answers:this.number_all_answers,accuracy:parseInt(t,10)})});if(o.ok)alert("Результаты успешно сохранены!");else{const l=await o.json();alert(l.detail||"Ошибка при сохранении результатов")}}catch(o){console.error("Ошибка при отправке результатов:",o),alert("Произошла ошибка при отправке данных на сервер")}}}},v={class:"container mt-5 text-center"},g={id:"app"},y={key:0},C={key:1},q={class:"horizontal-options"},V=["onClick"],N={class:"controls"},B={key:2},F={key:0};function A(i,t,o,l,s,r){const w=m("Navbar"),b=m("router-link");return c(),u(p,null,[d(w),e("div",v,[e("h2",null,n(i.$route.params.name),1),e("div",g,[s.currentView==="start"?(c(),u("div",y,[t[4]||(t[4]=e("h1",null,"Проверка на быстроту реакции и сообразительность",-1)),e("button",{id:"start-button",onClick:t[0]||(t[0]=(...a)=>r.startTest&&r.startTest(...a))},"Начать тест")])):s.currentView==="test"?(c(),u("div",C,[e("h2",null,"Вопрос "+n(s.currentQuestionIndex+1),1),e("p",null,n(r.currentQuestion.text),1),e("ul",q,[(c(!0),u(p,null,k(r.currentQuestion.options,(a,h)=>(c(),u("button",{key:h,onClick:G=>r.checkAnswer(h)},n(a),9,V))),128))]),e("p",null,"Ошибки: "+n(s.missClicks),1),e("p",null,"Время: "+n(r.formatTime(s.timer)),1),e("div",N,[e("button",{onClick:t[1]||(t[1]=(...a)=>r.endTest&&r.endTest(...a)),id:"text"},"Завершить тест")])])):s.currentView==="result"?(c(),u("div",B,[t[5]||(t[5]=e("h1",null,"Результаты теста",-1)),e("p",null,"Правильных ответов: "+n(s.number_correct_answers)+" из "+n(s.number_all_answers),1),e("p",null,[T("Ошибок: "+n(s.missClicks)+" ",1),s.missClicks>0?(c(),u("span",F," (Вопросы: "+n(s.errorQuestions.join(", "))+")",1)):_("",!0)]),e("p",null,"Общее время: "+n(r.formatTime(s.totalTime)),1),e("p",null,"Точность: "+n(r.accuracy)+"%",1),e("p",null,"Самый сложный вопрос: Вопрос №"+n(s.hardestQuestionIndex+1)+" (время: "+n(s.hardestQuestionTime.toFixed(3))+" сек)",1),e("button",{onClick:t[2]||(t[2]=(...a)=>r.restartTest&&r.restartTest(...a)),id:"text"},"Пройти заново"),e("button",{onClick:t[3]||(t[3]=(...a)=>r.goBack&&r.goBack(...a)),id:"text"},"Вернуться назад")])):_("",!0)]),d(b,{to:"/tests",class:"btn btn-secondary"},{default:Q(()=>t[6]||(t[6]=[T("Назад к тестам")])),_:1})])],64)}const M=x(I,[["render",A],["__scopeId","data-v-7e2c013b"]]);export{M as default};
