import{_ as S,a as w,r as f,c as n,o as i,b as _,d as s,t as a,e as c,g as h,F as b,f as g,n as v,w as T,u as y}from"./index-BFI9Nzsh.js";const k={components:{Navbar:w},setup(){return{authStore:y()}},data(){return{testStarted:!1,testFinished:!1,timeLeft:60,timer:null,targetNumbers:[],gridNumbers:[],selectedIndexes:[],startTime:null,time:"00:00:00",number_all_answers:10,number_correct_answers:0,number_total_numbers:100}},computed:{formattedTime(){return`00:00:${this.timeLeft.toString().padStart(2,"0")}`},accuracy(){return(this.number_correct_answers/this.number_all_answers*100).toFixed(2)}},methods:{formatTime(t){const e=Math.floor(t/3600).toString().padStart(2,"0"),l=Math.floor(t%3600/60).toString().padStart(2,"0"),m=(t%60).toString().padStart(2,"0");return`${e}:${l}:${m}`},startTest(){this.testStarted=!0,this.testFinished=!1,this.targetNumbers=this.generateRandomNumbers(this.number_all_answers),this.gridNumbers=this.generateGridNumbers(this.number_total_numbers,this.targetNumbers),this.selectedIndexes=[],this.startTime=Date.now(),this.startTimer()},startTimer(){this.timer=setInterval(()=>{this.timeLeft>0?this.timeLeft--:this.finishTest()},1e3)},generateRandomNumbers(t){const e=new Set;for(;e.size<t;)e.add(Math.floor(100+Math.random()*900));return Array.from(e)},generateGridNumbers(t,e){const l=[...e];for(;l.length<t;){const m=Math.floor(100+Math.random()*900);l.includes(m)||l.push(m)}return l.sort(()=>Math.random()-.5)},toggleCell(t){if(this.testFinished)return;const e=this.selectedIndexes.indexOf(t);e!==-1?this.selectedIndexes.splice(e,1):this.selectedIndexes.push(t)},getCellClass(t){if(this.testFinished){const e=this.targetNumbers.includes(this.gridNumbers[t]);return this.selectedIndexes.includes(t)?e?"correct":"wrong":""}return this.selectedIndexes.includes(t)?"highlighted":""},finishTest(){this.testFinished=!0,clearInterval(this.timer);const t=60-this.timeLeft;this.time=this.formatTime(t),this.number_correct_answers=this.selectedIndexes.filter(e=>this.targetNumbers.includes(this.gridNumbers[e])).length,this.saveResults()},async saveResults(){if(!this.authStore.user){alert("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω. –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É.");return}try{const t=await fetch("http://127.0.0.1:8000/api/result/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({test:18,user:this.authStore.user.id,score_percentage:Math.round(this.accuracy),time:this.time,number_all_answers:this.number_all_answers,number_correct_answers:this.number_correct_answers})});if(t.ok)alert("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!");else{const e=await t.json();console.error("–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞:",e),alert(e.error||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤")}}catch(t){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:",t)}}},beforeUnmount(){clearInterval(this.timer)}},C={class:"container mt-5 text-center"},I={id:"app"},x={key:0},F={key:1},M={class:"numbers-row"},L={class:"grid"},B=["onClick"],R={key:2,class:"end-message"};function V(t,e,l,m,r,o){const p=f("Navbar"),N=f("router-link");return i(),n(b,null,[_(p),s("div",C,[s("h2",null,a(t.$route.params.name),1),s("div",I,[!r.testStarted&&!r.testFinished?(i(),n("div",x,[e[6]||(e[6]=s("h1",null,"–¢–µ—Å—Ç –Ω–∞ –∏–∑–±–∏—Ä–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–Ω–∏–º–∞–Ω–∏—è",-1)),s("p",null,[e[2]||(e[2]=h(" –í—ã —É–≤–∏–¥–∏—Ç–µ –ø–µ—Ä–µ–¥ —Å–æ–±–æ–π ")),e[3]||(e[3]=s("strong",null,"10",-1)),h(" –∑–∞–¥–∞–Ω–Ω—ã—Ö —á–∏—Å–µ–ª, –∞ –Ω–∏–∂–µ —Ç–∞–±–ª–∏—Ü—É –∏–∑ "+a(r.number_total_numbers)+" —è—á–µ–µ–∫ —Å —Ç—Ä–µ—Ö–∑–Ω–∞—á–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏. –í–∞—à–∞ –∑–∞–¥–∞—á–∞ ‚Äî –∫–∞–∫ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ –Ω–∞–π—Ç–∏ –∏ –≤—ã–¥–µ–ª–∏—Ç—å —ç—Ç–∏ ",1),e[4]||(e[4]=s("strong",null,"10 —á–∏—Å–µ–ª",-1)),e[5]||(e[5]=h(". "))]),s("button",{class:"start-button btn btn-primary",onClick:e[0]||(e[0]=(...u)=>o.startTest&&o.startTest(...u))},"–ù–∞—á–∞—Ç—å")])):r.testStarted?(i(),n("div",F,[s("p",null,"–û—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è: "+a(o.formattedTime),1),s("div",null,[e[7]||(e[7]=s("h2",null,"–ó–∞–¥–∞–Ω–Ω—ã–µ —á–∏—Å–ª–∞:",-1)),s("div",M,[(i(!0),n(b,null,g(r.targetNumbers,(u,d)=>(i(),n("span",{key:d},a(u),1))),128))])]),s("div",L,[(i(!0),n(b,null,g(r.gridNumbers,(u,d)=>(i(),n("div",{key:d,class:v(o.getCellClass(d)),onClick:z=>o.toggleCell(d)},a(u),11,B))),128))]),r.timeLeft>0?(i(),n("button",{key:0,onClick:e[1]||(e[1]=(...u)=>o.finishTest&&o.finishTest(...u)),class:"btn btn-success mt-3"},"–ì–æ—Ç–æ–≤–æ")):c("",!0)])):c("",!0),r.testFinished?(i(),n("div",R,[e[8]||(e[8]=s("h3",null,"–¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!",-1)),s("p",null,"‚è≥ –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: "+a(r.time),1),s("p",null,"‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã: "+a(r.number_correct_answers)+" –∏–∑ "+a(r.number_all_answers),1),s("p",null,"üéØ –¢–æ—á–Ω–æ—Å—Ç—å: "+a(o.accuracy)+"%",1)])):c("",!0),_(N,{to:"/tests",class:"btn btn-secondary"},{default:T(()=>e[9]||(e[9]=[h("–ù–∞–∑–∞–¥ –∫ —Ç–µ—Å—Ç–∞–º")])),_:1})])])],64)}const D=S(k,[["render",V],["__scopeId","data-v-bccb3ffe"]]);export{D as default};
