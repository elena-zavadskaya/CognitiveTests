import{_ as C,a as f,r as u,c as a,o as c,b as p,d as s,e as g,t as o,F as h,f as A,w as S,g as T,u as k}from"./index-BFI9Nzsh.js";/* empty css                                                       */const v="/assets/triangleCircle-Bn9j-Qlc.png",y="/assets/96-CTw8jDq6.png",x="/assets/13-ApgoiExm.png",I="/assets/95-CNVfnGmA.png",D="/assets/triangleCircle(3)-7L93EnfV.png",Q="/assets/9-BmOVEJOz.png",B="/assets/13(2)-m-mjxtcn.png",E="/assets/66-DBkegKUc.png",N="/assets/triangleCircle(2)-D0rIYx6B.png",_="/assets/96(2)-DIiciRD3.png",V="/assets/triangleCircle(5)-C2EIsKqv.png",q="/assets/36-Bg5WvJ4_.png",j="/assets/136-DgGuJqhz.png",F="/assets/triangleCircle(4)-CkbhkoAp.png",J="/assets/30-DwU6N12F.png",M="/assets/9(2)-BxYrcn8y.png",O={components:{Navbar:f},setup(){return{authStore:k()}},data(){return{testStarted:!1,testCompleted:!1,number_correct_answers:0,number_all_answers:0,currentQuestionIndex:0,startTime:null,timeElapsed:0,time:"00:00:00",timer:null,questions:[{image:v,correctAnswer:"Треугольник и круг",options:["Треугольник","Треугольник и круг","Круг","Ничего"]},{image:y,correctAnswer:"96",options:["6","Ничего","9","96"]},{image:x,correctAnswer:"13",options:["9","1","13","5"]},{image:I,correctAnswer:"95",options:["95","Ничего","9","5"]},{image:D,correctAnswer:"Треугольник и круг",options:["Ничего","Круг","Треугольник","Треугольник и круг"]},{image:Q,correctAnswer:"9",options:["6","8","9","Ничего"]},{image:B,correctAnswer:"13",options:["1","13","Ничего","3"]},{image:E,correctAnswer:"66",options:["9","66","6","Ничего"]},{image:N,correctAnswer:"Треугольник и круг",options:["Ничего","Круг","Треугольник","Треугольник и круг"]},{image:_,correctAnswer:"96",options:["96","Ничего","9","6"]},{image:V,correctAnswer:"Треугольник и круг",options:["Ничего","Треугольник","Круг","Треугольник и круг"]},{image:q,correctAnswer:"36",options:["3","6","Ничего","36"]},{image:j,correctAnswer:"136",options:["136","66","68","69"]},{image:F,correctAnswer:"Треугольник и круг",options:["Треугольник и квадрат","Треугольник и круг","Два треугольника и квадрат","Ничего"]},{image:_,correctAnswer:"96",options:["Ничего","6","9","96"]},{image:J,correctAnswer:"30",options:["6","10","30","Ничего"]},{image:M,correctAnswer:"9",options:["0","9","Ничего","2"]}]}},computed:{currentQuestion(){return this.questions[this.currentQuestionIndex]},accuracy(){return this.number_all_answers>0?(this.number_correct_answers/this.number_all_answers*100).toFixed(2):"0.00"}},methods:{formatTime(t){const e=Math.floor(t/3600).toString().padStart(2,"0"),l=Math.floor(t%3600/60).toString().padStart(2,"0"),m=(t%60).toString().padStart(2,"0");return`${e}:${l}:${m}`},startTest(){this.testStarted=!0,this.testCompleted=!1,this.number_correct_answers=0,this.number_all_answers=this.questions.length,this.currentQuestionIndex=0,this.timeElapsed=0,this.startTime=Date.now(),this.startTimer()},startTimer(){this.timer=setInterval(()=>{this.timeElapsed=Math.floor((Date.now()-this.startTime)/1e3)},1e3)},checkAnswer(t){t===this.currentQuestion.correctAnswer&&this.number_correct_answers++,this.currentQuestionIndex<this.number_all_answers-1?this.currentQuestionIndex++:this.endTest()},endTest(){clearInterval(this.timer),this.testCompleted=!0,this.time=this.formatTime(this.timeElapsed),this.saveResults()},resetTest(){this.testStarted=!1,this.testCompleted=!1,this.timeElapsed=0,this.time="00:00:00",clearInterval(this.timer)},async saveResults(){if(!this.authStore.user){alert("Пользователь не авторизован. Войдите в систему.");return}try{const t=await fetch("http://127.0.0.1:8000/api/result/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({test:16,user:this.authStore.user.id,score_percentage:Math.round(this.accuracy),time:this.time,number_all_answers:this.number_all_answers,number_correct_answers:this.number_correct_answers})});if(t.ok)alert("Результаты успешно сохранены!");else{const e=await t.json();alert(e.error||"Ошибка при сохранении результатов")}}catch(t){console.error("Ошибка при отправке результатов:",t)}}},beforeUnmount(){clearInterval(this.timer)}},z={class:"container mt-5 text-center"},R={class:"color-blindness-test"},U={key:0},G={key:1},K=["src"],L={class:"answers"},Y=["onClick"],P={key:2};function W(t,e,l,m,r,n){const d=u("Navbar"),w=u("router-link");return c(),a(h,null,[p(d),s("div",z,[s("div",R,[s("h2",null,o(t.$route.params.name),1),!r.testStarted&&!r.testCompleted?(c(),a("div",U,[e[2]||(e[2]=s("p",null,"Ваша задача: выбрать правильное число, которое вы видите на изображении.",-1)),s("button",{class:"start-button btn btn-primary",onClick:e[0]||(e[0]=(...i)=>n.startTest&&n.startTest(...i))},"Начать тест")])):r.testStarted&&!r.testCompleted?(c(),a("div",G,[s("p",null,"Вопрос "+o(r.currentQuestionIndex+1)+" из "+o(r.number_all_answers),1),s("img",{src:n.currentQuestion.image,alt:"Тест на цветовое зрение"},null,8,K),s("div",L,[(c(!0),a(h,null,A(n.currentQuestion.options,(i,b)=>(c(),a("button",{key:b,class:"btn btn-outline-primary mx-1",onClick:H=>n.checkAnswer(i)},o(i),9,Y))),128))])])):g("",!0),r.testCompleted?(c(),a("div",P,[s("p",null,"Ваш результат: "+o(r.number_correct_answers)+" из "+o(r.number_all_answers),1),s("p",null,"Точность: "+o(n.accuracy)+"%",1),s("p",null,"Время выполнения: "+o(r.time),1),s("button",{class:"btn btn-secondary",onClick:e[1]||(e[1]=(...i)=>n.resetTest&&n.resetTest(...i))},"Пройти заново")])):g("",!0),p(w,{to:"/tests",class:"btn btn-secondary"},{default:S(()=>e[3]||(e[3]=[T("Назад к тестам")])),_:1})])])],64)}const $=C(O,[["render",W]]);export{$ as default};
