import{_ as v,a as k,r as p,c as s,o as r,b as y,d as e,e as d,t as i,F as h,f as b,i as T,v as R,n as S,w as x,g as I,u as A}from"./index-BFI9Nzsh.js";const V={components:{Navbar:k},setup(){return{authStore:A()}},data(){return{stage:"intro",message:"Приготовились",currentNumber:null,currentRowNumber:null,showRowNumber:!1,results:Array.from({length:5},()=>Array(3).fill(null)),userInputs:Array.from({length:5},()=>Array(3).fill("")),isSubmitted:!1,rowIndex:0,numIndex:0,numbers:[],numbersDisplayed:!1,startTimeValue:null,timeElapsed:0,time:"00:00:00",number_all_answers:15,number_correct_answers:0}},computed:{accuracy(){let a=0,n=this.results.length*this.results[0].length;return this.userInputs.forEach((_,w)=>{_.forEach((t,l)=>{Number(t)===this.results[w][l]&&a++})}),this.number_correct_answers=a,(a/n*100).toFixed(2)}},methods:{startTest(){this.startTimeValue=Date.now(),this.startRow()},startRow(){if(this.rowIndex>=5){this.stage="input";return}this.stage="numbers",this.currentRowNumber=this.rowIndex+1,this.numbers=Array.from({length:4},()=>Math.floor(Math.random()*9)+1),this.results[this.rowIndex]=[this.numbers[0]+this.numbers[1],this.numbers[1]+this.numbers[2],this.numbers[2]+this.numbers[3]],this.showRowLabel()},showRowLabel(){this.showRowNumber=!0,setTimeout(()=>{this.showRowNumber=!1,setTimeout(()=>{this.showNextNumber()},1e3)},1e3)},showNextNumber(){if(this.numIndex>=this.numbers.length){this.numIndex=0,this.rowIndex++,this.rowIndex>=5&&(this.numbersDisplayed=!0),setTimeout(()=>{this.startRow()},1e3);return}this.currentNumber=this.numbers[this.numIndex],this.numIndex++,setTimeout(()=>{this.currentNumber=null,setTimeout(()=>{this.showNextNumber()},1e3)},1e3)},submitResults(){this.isSubmitted=!0,this.timeElapsed=(Date.now()-this.startTimeValue)/1e3,this.time=new Date(this.timeElapsed*1e3).toISOString().substr(11,8),this.saveResults()},resetTest(){this.stage="intro",this.rowIndex=0,this.numIndex=0,this.results=Array.from({length:5},()=>Array(3).fill(null)),this.userInputs=Array.from({length:5},()=>Array(3).fill("")),this.startTimeValue=null,this.timeElapsed=0,this.time="00:00:00",this.isSubmitted=!1,this.numbersDisplayed=!1},async saveResults(){if(!this.authStore.user){alert("Пользователь не авторизован. Войдите в систему.");return}try{await fetch("http://127.0.0.1:8000/api/result/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({test:20,user:this.authStore.user.id,score_percentage:Math.round(this.accuracy),time:this.time,number_all_answers:this.number_all_answers,number_correct_answers:this.number_correct_answers})}),alert("Результаты успешно сохранены!")}catch(a){console.error("Ошибка при отправке результатов:",a)}}}},C={class:"memory-test"},D={key:0,class:"start-btn-container"},E={class:"screen"},B={key:0},M={key:1},F={key:0,class:"row-number"},L={key:1,class:"number"},O={key:1,class:"input-table"},z=["onUpdate:modelValue","disabled"],U=["disabled"],j={key:2,class:"results"},J={class:"result-tables"},P={class:"correct-table"},q={class:"user-table"},G={class:"restart-btn-container"};function H(a,n,_,w,t,l){const f=p("Navbar"),g=p("router-link");return r(),s(h,null,[y(f),e("div",C,[e("h2",null,i(a.$route.params.name),1),n[7]||(n[7]=e("p",{class:"description"}," Внимательно смотрите на экран и запоминайте появляющиеся на нем цифры для дальнейшего сложения. Ваша цель — сложить первую цифру со второй, вторую с третьей и так далее. Введите ответы в таблицу ниже. ",-1)),t.stage==="intro"?(r(),s("div",D,[e("button",{onClick:n[0]||(n[0]=(...u)=>l.startTest&&l.startTest(...u)),class:"start-btn"},"Начать")])):d("",!0),e("div",E,[t.stage==="intro"?(r(),s("div",B,i(t.message),1)):t.stage==="numbers"?(r(),s("div",M,[t.showRowNumber?(r(),s("div",F,"Ряд №"+i(t.currentRowNumber),1)):(r(),s("div",L,i(t.currentNumber),1))])):d("",!0)]),t.stage!=="intro"?(r(),s("div",O,[e("table",null,[(r(!0),s(h,null,b(t.results,(u,o)=>(r(),s("tr",{key:"row-"+o},[(r(!0),s(h,null,b(t.results[o],(c,m)=>(r(),s("td",{key:"col-"+m},[T(e("input",{type:"number","onUpdate:modelValue":N=>t.userInputs[o][m]=N,disabled:t.isSubmitted},null,8,z),[[R,t.userInputs[o][m]]])]))),128))]))),128))]),e("button",{onClick:n[1]||(n[1]=(...u)=>l.submitResults&&l.submitResults(...u)),disabled:t.isSubmitted||!t.numbersDisplayed,class:"submit-btn"},"Готово",8,U)])):d("",!0),t.isSubmitted?(r(),s("div",j,[n[5]||(n[5]=e("h3",null,"Результаты:",-1)),e("p",null,"Точность: "+i(l.accuracy)+"%",1),e("p",null,"Время выполнения: "+i(t.time),1),e("p",null,"Правильные ответы: "+i(t.number_correct_answers)+" из "+i(t.number_all_answers),1),e("div",J,[e("div",null,[n[3]||(n[3]=e("h4",null,"Правильные ответы:",-1)),e("table",P,[(r(!0),s(h,null,b(t.results,(u,o)=>(r(),s("tr",{key:"result-row-"+o},[(r(!0),s(h,null,b(u,(c,m)=>(r(),s("td",{key:"correct-"+m},i(c),1))),128))]))),128))])]),e("div",null,[n[4]||(n[4]=e("h4",null,"Ваши ответы:",-1)),e("table",q,[(r(!0),s(h,null,b(t.userInputs,(u,o)=>(r(),s("tr",{key:"input-row-"+o},[(r(!0),s(h,null,b(u,(c,m)=>(r(),s("td",{key:"input-"+m,class:S({correct:c==t.results[o][m]})},i(c),3))),128))]))),128))])])]),e("div",G,[e("button",{onClick:n[2]||(n[2]=(...u)=>l.resetTest&&l.resetTest(...u)),class:"restart-btn"},"Начать заново")])])):d("",!0),y(g,{to:"/tests",class:"btn btn-secondary"},{default:x(()=>n[6]||(n[6]=[I("Назад к тестам")])),_:1})])],64)}const Q=v(V,[["render",H],["__scopeId","data-v-a755aee3"]]);export{Q as default};
