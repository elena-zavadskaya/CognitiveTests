import{_ as v,a as F,r as C,c as a,o as i,b as p,d as o,t as u,e as b,h as g,F as f,f as y,j as k,w,g as S,u as T}from"./index-BFI9Nzsh.js";/* empty css                                                       */const x={components:{Navbar:F},setup(){return{authStore:T()}},data(){return{round:1,leftColor:"",rightColor:"",originalMovableColors:[],movableColors:[],draggedIndex:null,testStarted:!1,testCompleted:!1,testFinished:!1,correctMovableColors:0,number_correct_answers:0,number_all_answers:0,startTime:0,endTime:0,time:"00:00:00"}},computed:{accuracy(){return this.number_all_answers>0?(this.number_correct_answers/this.number_all_answers*100).toFixed(2):"0.00"}},methods:{generateColors(){const e=3+Math.floor(this.round/2),t=[["#FFFF00","#00FF00"],["#0000FF","#FF0000"],["#FF00FF","#00FFFF"],["#FFA500","#800080"]],h=(this.round-1)%t.length;[this.leftColor,this.rightColor]=t[h];const[l,r]=[this.leftColor,this.rightColor].map(this.hexToRgb),s={r:(r.r-l.r)/(e+1),g:(r.g-l.g)/(e+1),b:(r.b-l.b)/(e+1)};this.originalMovableColors=Array.from({length:e},(_,c)=>{const n=Math.round(l.r+s.r*(c+1)),d=Math.round(l.g+s.g*(c+1)),m=Math.round(l.b+s.b*(c+1));return`rgb(${n}, ${d}, ${m})`}),this.movableColors=[...this.originalMovableColors].sort(()=>Math.random()-.5),this.number_all_answers+=e},hexToRgb(e){const t=parseInt(e.slice(1),16);return{r:t>>16&255,g:t>>8&255,b:t&255}},formatTime(e){const t=Math.floor(e/3600).toString().padStart(2,"0"),h=Math.floor(e%3600/60).toString().padStart(2,"0"),l=(e%60).toString().padStart(2,"0");return`${t}:${h}:${l}`},dragStart(e){this.draggedIndex=e},drop(e){const t=this.movableColors[this.draggedIndex];this.movableColors.splice(this.draggedIndex,1),this.movableColors.splice(e,0,t)},checkResult(){this.correctMovableColors=this.movableColors.reduce((e,t,h)=>t===this.originalMovableColors[h]?e+1:e,0),this.number_correct_answers+=this.correctMovableColors,this.testCompleted=!0},nextRound(){this.round++,this.testCompleted=!1,this.generateColors()},finishTest(){this.endTime=Date.now();const e=Math.floor((this.endTime-this.startTime)/1e3);this.time=this.formatTime(e),this.testFinished=!0,this.saveResults()},startTest(){this.round=1,this.number_correct_answers=0,this.number_all_answers=0,this.testStarted=!0,this.testCompleted=!1,this.testFinished=!1,this.startTime=Date.now(),this.generateColors()},async saveResults(){if(!this.authStore.user){alert("Пользователь не авторизован.");return}try{if(!(await fetch("http://127.0.0.1:8000/api/result/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({test:17,user:this.authStore.user.id,score_percentage:Math.round(this.accuracy),time:this.time,number_all_answers:this.number_all_answers,number_correct_answers:this.number_correct_answers})})).ok)throw new Error("Ошибка при сохранении данных");alert("Результаты успешно сохранены!")}catch(e){console.error("Ошибка:",e)}}}},M={class:"container mt-5 text-center"},R={id:"app"},D={key:0},N={key:1},I={class:"color-container"},A=["onDragstart","onDrop"],B={key:2},V={key:3,class:"end-message"};function j(e,t,h,l,r,s){const _=C("Navbar"),c=C("router-link");return i(),a(f,null,[p(_),o("div",M,[o("h2",null,u(e.$route.params.name),1),o("div",R,[!r.testStarted&&!r.testFinished?(i(),a("div",D,[t[5]||(t[5]=o("h1",null,"Тест на цветовую последовательность",-1)),t[6]||(t[6]=o("p",null,"Перетащите и отпустите ящики, чтобы расположить оттенки в правильной последовательности.",-1)),o("button",{class:"start-button btn btn-primary",onClick:t[0]||(t[0]=(...n)=>s.startTest&&s.startTest(...n))},"Начать тест")])):r.testStarted&&!r.testFinished?(i(),a("div",N,[o("p",null,"Раунд "+u(r.round)+" из 16",1),o("div",I,[o("div",{class:"color-box fixed",style:g({backgroundColor:r.leftColor})},null,4),(i(!0),a(f,null,y(r.movableColors,(n,d)=>(i(),a("div",{key:d,class:"color-box",style:g({backgroundColor:n}),draggable:"true",onDragstart:m=>s.dragStart(d),onDragover:t[1]||(t[1]=k(()=>{},["prevent"])),onDrop:m=>s.drop(d)},null,44,A))),128)),o("div",{class:"color-box fixed",style:g({backgroundColor:r.rightColor})},null,4)]),o("button",{class:"btn btn-primary",onClick:t[2]||(t[2]=(...n)=>s.checkResult&&s.checkResult(...n))},"Проверить")])):b("",!0),r.testCompleted&&!r.testFinished?(i(),a("div",B,[o("p",null,"Вы правильно расположили "+u(r.correctMovableColors)+" из "+u(r.movableColors.length)+" оттенков!",1),r.round<16?(i(),a("button",{key:0,class:"btn btn-primary",onClick:t[3]||(t[3]=(...n)=>s.nextRound&&s.nextRound(...n))},"Следующий раунд")):(i(),a("button",{key:1,class:"btn btn-primary",onClick:t[4]||(t[4]=(...n)=>s.finishTest&&s.finishTest(...n))},"Завершить тест"))])):b("",!0),r.testFinished?(i(),a("div",V,[o("p",null,"Тест завершён! Вы правильно расположили "+u(r.number_correct_answers)+" из "+u(r.number_all_answers)+" оттенков.",1),o("p",null,"Точность выполнения: "+u(s.accuracy)+"%",1),o("p",null,"Общее время прохождения: "+u(r.time),1)])):b("",!0),p(c,{to:"/tests",class:"btn btn-secondary"},{default:w(()=>t[7]||(t[7]=[S("Назад к тестам")])),_:1})])])],64)}const O=v(x,[["render",j]]);export{O as default};
