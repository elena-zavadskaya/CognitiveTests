import{_ as b,a as p,r as h,c as o,o as i,b as m,d as r,t as l,e as d,F as _,f as k,w as g,g as y,u as T}from"./index-BFI9Nzsh.js";const S={components:{Navbar:p},setup(){return{authStore:T()}},data(){return{words:["ФАКТ","ТЕОРИЯ","БИЗНЕС","ДОЧИСЛО","КАРТЕ","МАРКЕТИНГ","ДАННЫЕ","ДЕНЬГИ","КЛЮЧ","КУСТ","АНАЛИЗ","ДИАГНОЗ","ПРОБЛЕМА","РЕШЕНИЕ","ПЛАН","КОНЦЕПЦИЯ","СТРАТЕГИЯ","МОДЕЛЬ","ИССЛЕДОВАНИЕ","РЕСУРС","ИНФОРМАЦИЯ","ПРОЦЕСС","СИСТЕМА","КОММУНИКАЦИЯ","ПАРТНЁР","ПРОЕКТ","УСПЕХ","ДИАЛОГ","КОНТРОЛЬ","ОЦЕНКА"],randomText:"",foundCount:null,options:[],selectedOption:null,feedback:"",isAnswered:!1,testStarted:!1,time:"00:00:00",accuracy:0,number_all_answers:0,number_correct_answers:0}},methods:{startTest(){this.testStarted=!0,this.startTime=Date.now(),this.generateRandomText()},generateRandomText(){let e="";const n=new Set;for(;e.length<350&&n.size!==this.words.length;){const u=this.words[Math.floor(Math.random()*this.words.length)];if(!n.has(u)){n.add(u);const s=Math.floor(Math.random()*(e.length+1));e=this.insertWord(u,e,s)}}for(;e.length<350;)e+=" ";this.randomText=e.trim()},insertWord(e,t,n){return t.slice(0,n)+e+t.slice(n)},checkWords(){const e=new RegExp(this.words.join("|"),"g"),t=this.randomText.match(e)||[];this.foundCount=t.length,this.number_all_answers=this.foundCount,this.generateOptions()},generateOptions(){const e=this.foundCount,t=new Set([e]);for(;t.size<4;){const n=Math.floor(Math.random()*(this.words.length+1));t.add(n)}this.options=Array.from(t).sort((n,u)=>n-u)},checkAnswer(e){this.selectedOption=e,this.number_correct_answers=e,e===this.foundCount?this.feedback="Правильно!":this.feedback=`Неправильно! Правильный ответ: ${this.foundCount}`,this.isAnswered=!0,this.calculateResults()},calculateResults(){const e=Math.floor((Date.now()-this.startTime)/1e3);this.time=this.formatTime(e),this.accuracy=this.number_all_answers>0?(this.number_correct_answers/this.number_all_answers*100).toFixed(2):"0.00",this.saveResults()},formatTime(e){const t=String(Math.floor(e/60)).padStart(2,"0"),n=String(e%60).padStart(2,"0");return`00:${t}:${n}`},async saveResults(){if(!this.authStore.user){alert("Пользователь не авторизован. Пожалуйста, войдите в систему.");return}const e=12,t=this.accuracy;try{(await fetch("http://127.0.0.1:8000/api/result/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({test:e,user:this.authStore.user.id,score_percentage:Math.round(t),time:this.time,number_all_answers:this.number_all_answers,number_correct_answers:this.number_correct_answers})})).ok?alert("Результаты успешно сохранены!"):alert("Ошибка при сохранении результатов")}catch(n){console.error("Ошибка при отправке результатов:",n)}},retryTest(){this.isAnswered=!1,this.selectedOption=null,this.feedback="",this.foundCount=null,this.options=[],this.randomText="",this.testStarted=!1,this.time="00:00:00",this.accuracy=0}}},C={class:"container mt-5 text-center"},x={id:"app"},v={class:"container"},A={key:1},M=["innerHTML"],O={key:0,class:"quiz"},N=["onClick","disabled"],R={key:0,class:"feedback"},W={key:1,class:"success-message"},L={key:2,class:"results"};function z(e,t,n,u,s,c){const f=h("Navbar"),w=h("router-link");return i(),o(_,null,[m(f),r("div",C,[r("h2",null,l(e.$route.params.name),1),r("div",x,[r("div",v,[t[6]||(t[6]=r("h2",null,"Тест на внимание «Мюнстерберга»",-1)),s.testStarted?(i(),o("div",A,[r("p",{class:"random-text",innerHTML:s.randomText},null,8,M),r("button",{class:"check-button",onClick:t[1]||(t[1]=(...a)=>c.checkWords&&c.checkWords(...a))},"Проверить количество найденных слов"),s.foundCount!==null?(i(),o("div",O,[t[3]||(t[3]=r("h2",null,"Сколько слов было найдено?",-1)),(i(!0),o(_,null,k(s.options,a=>(i(),o("div",{key:a,class:"option"},[r("button",{onClick:B=>c.checkAnswer(a),disabled:s.isAnswered},l(a),9,N)]))),128)),s.selectedOption!==null?(i(),o("p",R,l(s.feedback),1)):d("",!0)])):d("",!0),s.isAnswered&&s.feedback==="Правильно!"?(i(),o("p",W," Вы нашли "+l(s.foundCount)+" слов(а). ",1)):d("",!0),s.isAnswered?(i(),o("div",L,[r("p",null,"Время выполнения теста: "+l(s.time),1),r("p",null,"Точность: "+l(s.accuracy)+"%",1),r("p",null,"Найдено слов: "+l(s.number_correct_answers)+" из "+l(s.number_all_answers),1)])):d("",!0),s.isAnswered?(i(),o("button",{key:3,class:"retry-button",onClick:t[2]||(t[2]=(...a)=>c.retryTest&&c.retryTest(...a))}," Пройти тест еще раз ")):d("",!0),t[5]||(t[5]=r("br",null,null,-1)),m(w,{to:"/tests",class:"btn btn-secondary"},{default:g(()=>t[4]||(t[4]=[y("Назад к тестам")])),_:1})])):(i(),o("button",{key:0,class:"start-button",onClick:t[0]||(t[0]=(...a)=>c.startTest&&c.startTest(...a))}," Играть "))])])])],64)}const D=b(S,[["render",z]]);export{D as default};
