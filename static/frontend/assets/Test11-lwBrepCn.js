import{_ as b,a as w,r as g,c as o,o as c,b as f,d as t,t as l,e as v,F as m,f as h,n as _,w as y,g as I,u as A}from"./index-BFI9Nzsh.js";const N="/assets/dog-vibTnq4P.png",M="/assets/cat-DI8NEaEF.png",B="/assets/horse-D1PTVqTG.png",C="/assets/cow-Dmc9Q2Vd.png",F="/assets/bird-DMDsiRxI.png",P="/assets/sheep-Cr7ipWBx.png",T="/assets/rat-BNlL5k6Z.png",G="/assets/pig-B38kSVRY.png",D="/assets/duck-DZjkUjlV.png",x="/assets/wild_boar-Heszm_Xa.png",V="/assets/dog-nATtoBMJ.mp3",L="/assets/cat-Bk-uk1Nd.mp3",E="/assets/horse-BG0VGlWQ.mp3",z="/assets/cow-CapRPn3q.mp3",O="/assets/bird-Ct3ftUX4.mp3",R="/assets/sheep-DIz1UBs2.mp3",j="/assets/rat-D8HkE1Gz.mp3",q="/assets/pig-C16-ZsLq.mp3",J="/assets/duck-CNyDdcOB.mp3",U="/assets/wild_boar-BN5BrwOP.mp3",Z={components:{Navbar:w},setup(){return{authStore:A()}},data(){return{animals:[{name:"Собака",image:N},{name:"Кошка",image:M},{name:"Лошадь",image:B},{name:"Корова",image:C},{name:"Птица",image:F},{name:"Овца",image:P},{name:"Крыса",image:T},{name:"Свинья",image:G},{name:"Утка",image:D},{name:"Кабан",image:x}],sounds:[{name:"Собака",audio:V},{name:"Кошка",audio:L},{name:"Лошадь",audio:E},{name:"Корова",audio:z},{name:"Птица",audio:O},{name:"Овца",audio:R},{name:"Крыса",audio:j},{name:"Свинья",audio:q},{name:"Утка",audio:J},{name:"Кабан",audio:U}],selectedPairs:[],selectedAnimals:[],selectedSounds:[],timeLeft:60,timeFormatted:"00:00:00",gameFinished:!1,gameStarted:!1,timer:null,shuffledAnimals:[],shuffledSounds:[],number_correct_answers:0,number_all_answers:10}},computed:{accuracy(){const s=this.selectedPairs.filter(i=>i.animal.name===i.sound.name).length;this.number_correct_answers=s;const e=s/this.number_all_answers*100;return Number(e.toFixed(2))}},methods:{shuffleAnimals(){this.shuffledAnimals=this.animals.sort(()=>Math.random()-.5)},shuffleSounds(){this.shuffledSounds=this.sounds.sort(()=>Math.random()-.5)},selectAnimal(s){this.isMatched(s)||(this.selectedAnimals=[s],this.checkMatch())},selectSound(s){this.isMatched(s)||(this.selectedSounds=[s],this.checkMatch())},isMatched(s){return this.selectedPairs.some(e=>e.animal.name===s.name||e.sound.name===s.name)},isIncorrect(s){return s.incorrect},checkMatch(){if(this.selectedAnimals.length>0&&this.selectedSounds.length>0){const s=this.selectedAnimals[0],e=this.selectedSounds[0];s.name===e.name?(this.selectedPairs.push({animal:s,sound:e}),console.log("Пара добавлена:",s.name,e.name)):this.$nextTick(()=>{s.incorrect=!0,e.incorrect=!0}),this.selectedAnimals=[],this.selectedSounds=[],this.selectedPairs.length===this.animals.length&&(console.log("Все пары сопоставлены!"),this.endGame())}},formatTime(s){const e=Math.floor(s/3600),i=Math.floor(s%3600/60),d=s%60;return`${String(e).padStart(2,"0")}:${String(i).padStart(2,"0")}:${String(d).padStart(2,"0")}`},startTimer(){const s=Date.now();this.timer=setInterval(()=>{const e=Math.floor((Date.now()-s)/1e3);this.timeFormatted=this.formatTime(e),this.timeLeft--,this.timeLeft<=0&&(clearInterval(this.timer),this.endGame())},1e3)},endGame(){this.gameFinished=!0,clearInterval(this.timer),console.log("Игра завершена!"),this.saveResults()},restartGame(){this.animals.forEach(s=>s.incorrect=!1),this.sounds.forEach(s=>s.incorrect=!1),this.selectedPairs=[],this.selectedAnimals=[],this.selectedSounds=[],this.timeLeft=60,this.timeFormatted="00:00:00",this.gameFinished=!1,this.gameStarted=!1,this.shuffleAnimals(),this.shuffleSounds()},startGame(){this.gameStarted=!0,this.shuffleAnimals(),this.shuffleSounds(),this.startTimer()},async saveResults(){if(!this.authStore.user){alert("Пользователь не авторизован. Пожалуйста, войдите в систему.");return}const e={test:11,user:this.authStore.user.id,score_percentage:Math.round(this.accuracy),time:this.timeFormatted,number_all_answers:this.number_all_answers,number_correct_answers:this.number_correct_answers,accuracy:Math.round(this.accuracy)};if(isNaN(e.score_percentage)||isNaN(e.accuracy)){console.error("Некорректные значения:",e);return}console.log("Отправляемые данные:",e);try{const i=await fetch("http://127.0.0.1:8000/api/result/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify(e)}),d=await i.json();if(!i.ok)throw new Error(d.detail||d.error||JSON.stringify(d));alert("Результаты успешно сохранены!")}catch(i){console.error("Ошибка сохранения:",i),alert(`Ошибка: ${i.message}`)}}},mounted(){this.shuffleAnimals(),this.shuffleSounds()}},H={class:"container mt-5 text-center"},Q={id:"app"},W={key:0},X={key:1},Y={class:"game-container"},K={class:"animal-cards"},$={class:"card-container"},ee=["onClick"],se=["src"],te={class:"sound-cards"},ne={class:"sound-container"},ae={controls:""},re=["src"],ie=["onClick"],oe={key:0},ce={key:2};function le(s,e,i,d,a,r){const p=g("Navbar"),S=g("router-link");return c(),o(m,null,[f(p),t("div",H,[t("h2",null,l(s.$route.params.name),1),t("div",Q,[e[6]||(e[6]=t("h2",null,"Найди звуки животных!",-1)),!a.gameStarted&&!a.gameFinished?(c(),o("div",W,[t("button",{onClick:e[0]||(e[0]=(...n)=>r.startGame&&r.startGame(...n))},"Старт")])):a.gameFinished?(c(),o("div",ce,[e[5]||(e[5]=t("h2",null,"Игра окончена!",-1)),t("p",null,"Вы набрали: "+l(r.accuracy)+"%!",1),t("p",null,"Время выполнения: "+l(a.timeFormatted),1),t("p",null,"Правильных ответов: "+l(a.number_correct_answers)+" из "+l(a.number_all_answers),1),t("button",{onClick:e[1]||(e[1]=(...n)=>r.restartGame&&r.restartGame(...n))},"Начать заново")])):(c(),o("div",X,[t("div",Y,[t("div",K,[e[2]||(e[2]=t("h4",null,"Карточки с животными",-1)),t("div",$,[(c(!0),o(m,null,h(a.shuffledAnimals,(n,u)=>(c(),o("div",{key:n.name,class:_(["card",{matched:r.isMatched(n),"selected-animal":a.selectedAnimals.includes(n),incorrect:r.isIncorrect(n)}]),onClick:k=>r.selectAnimal(n)},[t("img",{src:n.image,alt:"animal"},null,8,se)],10,ee))),128))]),t("p",null,"Осталось времени: "+l(a.timeLeft),1),t("p",null,"Набранные проценты: "+l(r.accuracy)+"%",1)]),t("div",te,[e[3]||(e[3]=t("h4",null,"Карточки со звуками",-1)),t("div",ne,[(c(!0),o(m,null,h(a.shuffledSounds,(n,u)=>(c(),o("div",{key:n.name,class:_(["sound-card",{matched:r.isMatched(n),"selected-sound":a.selectedSounds.includes(n),incorrect:r.isIncorrect(n)}])},[t("audio",ae,[t("source",{src:n.audio,type:"audio/mpeg"},null,8,re)]),t("button",{onClick:k=>r.selectSound(n)}," Нажмите для выбора ",8,ie)],2))),128))])])]),a.selectedPairs.length>0?(c(),o("div",oe,[e[4]||(e[4]=t("h4",null,"Правильно подобранные пары:",-1)),t("ul",null,[(c(!0),o(m,null,h(a.selectedPairs,(n,u)=>(c(),o("li",{key:u},l(n.animal.name)+" - "+l(n.sound.name),1))),128))])])):v("",!0)]))]),f(S,{to:"/tests",class:"btn btn-secondary"},{default:y(()=>e[7]||(e[7]=[I("Назад к тестам")])),_:1})])],64)}const me=b(Z,[["render",le],["__scopeId","data-v-11c10e14"]]);export{me as default};
