import{_ as v,a as S,r as f,c as o,o as i,b as p,d as s,t as a,e as h,g as m,F as g,f as k,n as R,w,u as _}from"./index.js";/* empty css                                              */const x={components:{Navbar:S},setup(){return{authStore:_()}},data(){return{gameStarted:!1,gameEnded:!1,currentRound:0,totalRounds:20,correctAnswers:0,feedback:"",leftBank:[],rightBank:[],maxValue:1,accuracy:0,time:0,startTime:null}},methods:{startGame(){this.gameStarted=!0,this.gameEnded=!1,this.currentRound=1,this.correctAnswers=0,this.feedback="",this.maxValue=1,this.accuracy=0,this.time=0,this.startTime=new Date,this.generateRound()},generateRound(){const r=Math.floor(Math.random()*5)+3,e=Math.floor(Math.random()*5)+3;this.leftBank=this.generateCoins(r),this.rightBank=this.generateCoins(e)},generateCoins(r){const e=[];for(let n=0;n<r;n++)e.push(Math.random()<.5?1:this.maxValue);return e},handleAnswer(r){const e=this.leftBank.reduce((u,t)=>u+t,0),n=this.rightBank.reduce((u,t)=>u+t,0);r==="left"&&e>=n||r==="right"&&n>=e?(this.feedback="Правильно!",this.correctAnswers++):this.feedback="Неправильно!",this.currentRound<this.totalRounds?(this.currentRound++,this.currentRound>10&&(this.maxValue=2),setTimeout(()=>{this.feedback="",this.generateRound()},1500)):this.endGame()},endGame(){this.gameStarted=!1,this.gameEnded=!0,this.accuracy=Math.round(this.correctAnswers/this.totalRounds*100);const r=new Date;this.time=((r-this.startTime)/1e3).toFixed(2),this.saveResults()},restartGame(){this.startGame()},async saveResults(){if(!this.authStore.user){alert("Пользователь не авторизован. Пожалуйста, войдите в систему.");return}const r=7,e=this.accuracy;try{const n=await fetch("http://127.0.0.1:8000/api/result/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({test:r,user:this.authStore.user.id,score_percentage:parseFloat(e)})});if(n.ok)alert("Результаты успешно сохранены!");else{const u=await n.json();alert(u.error||"Ошибка при сохранении результатов")}}catch(n){console.error("Ошибка при отправке результатов:",n)}}}},B={class:"container mt-5 text-center"},C={id:"app"},A={key:0},T={key:1},N={class:"game-area piggy-bank-game"},V={key:2,class:"end-message"};function G(r,e,n,u,t,c){const b=f("Navbar"),y=f("router-link");return i(),o(g,null,[p(b),s("div",B,[s("h2",null,a(r.$route.params.name),1),s("div",C,[!t.gameStarted&&!t.gameEnded?(i(),o("div",A,[e[3]||(e[3]=s("h1",null,'Игра "Копилка"',-1)),e[4]||(e[4]=s("p",null,[s("strong",null,'"Копилка"'),m(" — игра на развитие скорости мышления и вычислительных навыков. ")],-1)),e[5]||(e[5]=s("p",null,[s("strong",null,"Цель игры:"),m(' определить, в какой из копилок больше денег. Если суммы равны, можно выбрать любую. С каждым раундом добавляются монеты номиналом "2". ')],-1)),s("button",{class:"start-button btn btn-primary",onClick:e[0]||(e[0]=(...l)=>c.startGame&&c.startGame(...l))},"Начать игру")])):t.gameStarted?(i(),o("div",T,[s("p",null,"Раунд: "+a(t.currentRound)+" / "+a(t.totalRounds),1),s("div",N,[s("div",{class:"piggy-bank border p-3 mx-2",onClick:e[1]||(e[1]=l=>c.handleAnswer("left"))},[(i(!0),o(g,null,k(t.leftBank,(l,d)=>(i(),o("div",{key:"left-"+d,class:"coin"},a(l),1))),128))]),s("div",{class:"piggy-bank border p-3 mx-2",onClick:e[2]||(e[2]=l=>c.handleAnswer("right"))},[(i(!0),o(g,null,k(t.rightBank,(l,d)=>(i(),o("div",{key:"right-"+d,class:"coin"},a(l),1))),128))])]),t.feedback?(i(),o("p",{key:0,class:R(["message",{correct:t.feedback==="Правильно!",incorrect:t.feedback==="Неправильно!"}])},a(t.feedback),3)):h("",!0)])):h("",!0),t.gameEnded?(i(),o("div",V,[e[6]||(e[6]=s("h3",null,"Игра завершена!",-1)),s("p",null,"Правильных ответов: "+a(t.correctAnswers)+" из "+a(t.totalRounds),1),s("p",null,"Точность: "+a(t.accuracy)+"%",1),s("p",null,"Время: "+a(t.time)+" секунд",1)])):h("",!0),p(y,{to:"/tests",class:"btn btn-secondary mt-3"},{default:w(()=>e[7]||(e[7]=[m("Назад к тестам")])),_:1})])])],64)}const z=v(x,[["render",G]]);export{z as default};
