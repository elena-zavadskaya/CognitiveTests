import{_ as v,a as k,r as u,c as i,o,b as g,d as e,t as l,F as m,f,n as A,w as y,g as I,u as b}from"./index.js";const w="/dog.png",C="/cat.png",F="/horse.png",M="/cow.png",G="/bird.png",P="/sheep.png",N="/rat.png",T="/pig.png",x="/duck.png",B="/wild_boar.png",L="/dog.mp3",D="/cat.mp3",V="/horse.mp3",j="/cow.mp3",z="/bird.mp3",O="/sheep.mp3",R="/rat.mp3",E="/pig.mp3",J="/duck.mp3",q="/wild_boar.mp3",H={components:{Navbar:k},setup(){return{authStore:b()}},data(){return{animals:[{name:"Собака",image:w},{name:"Кошка",image:C},{name:"Лошадь",image:F},{name:"Корова",image:M},{name:"Птица",image:G},{name:"Овца",image:P},{name:"Крыса",image:N},{name:"Свинья",image:T},{name:"Утка",image:x},{name:"Кабан",image:B}],sounds:[{name:"Собака",audio:L},{name:"Кошка",audio:D},{name:"Лошадь",audio:V},{name:"Корова",audio:j},{name:"Птица",audio:z},{name:"Овца",audio:O},{name:"Крыса",audio:R},{name:"Свинья",audio:E},{name:"Утка",audio:J},{name:"Кабан",audio:q}],matchedPairs:[],selectedAnimal:null,selectedSound:null,time:0,timeLeft:60,gameFinished:!1,gameStarted:!1,timer:null,shuffledAnimals:[],shuffledSounds:[]}},computed:{accuracy(){return(this.matchedPairs.length/this.animals.length*100).toFixed(2)||0}},methods:{shuffleAnimals(){this.shuffledAnimals=this.animals.sort(()=>Math.random()-.5)},shuffleSounds(){this.shuffledSounds=this.sounds.sort(()=>Math.random()-.5)},selectAnimal(s){this.isMatched(s)||(this.selectedAnimal=s,this.checkMatch())},selectSound(s){this.selectedSound=s,this.checkMatch()},checkMatch(){this.selectedAnimal&&this.selectedSound&&(this.selectedAnimal.name===this.selectedSound.name&&!this.isMatched(this.selectedAnimal)&&this.matchedPairs.push(this.selectedAnimal),this.selectedAnimal=null,this.selectedSound=null,this.matchedPairs.length===this.animals.length&&this.endGame())},isMatched(s){return this.matchedPairs.includes(s)},startTimer(){const s=Date.now();this.timer=setInterval(()=>{this.timeLeft--,this.timeLeft<=0&&(clearInterval(this.timer),this.endGame())},1e3),setInterval(()=>{this.gameStarted&&!this.gameFinished&&(this.time=Math.floor((Date.now()-s)/1e3))},1e3)},endGame(){this.gameFinished=!0,clearInterval(this.timer),this.saveResults()},restartGame(){this.score=0,this.timeLeft=60,this.matchedPairs=[],this.time=0,this.gameFinished=!1,this.gameStarted=!1,this.shuffleAnimals(),this.shuffleSounds()},startGame(){this.gameStarted=!0,this.shuffleAnimals(),this.shuffleSounds(),this.startTimer()},async saveResults(){if(!this.authStore.user){alert("Пользователь не авторизован. Пожалуйста, войдите в систему.");return}const s=11,t=this.accuracy;try{const d=await fetch("http://127.0.0.1:8000/api/result/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({test:s,user:this.authStore.user.id,score_percentage:parseFloat(t)})});if(d.ok)alert("Результаты успешно сохранены!");else{const h=await d.json();alert(h.error||"Ошибка при сохранении результатов")}}catch(d){console.error("Ошибка при отправке результатов:",d)}}},mounted(){this.shuffleAnimals(),this.shuffleSounds()}},K={class:"container mt-5 text-center"},Q={id:"app"},U={key:0},W={key:1},X={class:"game-container"},Y={class:"animal-cards"},Z={class:"card-container"},$=["onClick"],ee=["src"],te={class:"sound-cards"},se={class:"sound-container"},ae={controls:""},ne=["src"],ie=["onClick"],oe={key:2};function re(s,t,d,h,r,n){const p=u("Navbar"),S=u("router-link");return o(),i(m,null,[g(p),e("div",K,[e("h2",null,l(s.$route.params.name),1),e("div",Q,[t[5]||(t[5]=e("h2",null,"Найди звуки животных!",-1)),!r.gameStarted&&!r.gameFinished?(o(),i("div",U,[e("button",{onClick:t[0]||(t[0]=(...a)=>n.startGame&&n.startGame(...a))},"Старт")])):r.gameFinished?(o(),i("div",oe,[t[4]||(t[4]=e("h2",null,"Игра окончена!",-1)),e("p",null,"Вы набрали: "+l(n.accuracy)+"%!",1),e("p",null,"Время выполнения: "+l(r.time)+" секунд!",1),e("button",{onClick:t[1]||(t[1]=(...a)=>n.restartGame&&n.restartGame(...a))},"Начать заново")])):(o(),i("div",W,[e("div",X,[e("div",Y,[t[2]||(t[2]=e("h4",null,"Карточки с животными",-1)),e("div",Z,[(o(!0),i(m,null,f(r.shuffledAnimals,(a,c)=>(o(),i("div",{key:c,class:A(["card",{matched:n.isMatched(a)}]),onClick:_=>n.selectAnimal(a)},[e("img",{src:a.image,alt:"animal"},null,8,ee)],10,$))),128))]),e("p",null,"Осталось времени: "+l(r.timeLeft),1),e("p",null,"Набранные проценты: "+l(n.accuracy)+"%",1)]),e("div",te,[t[3]||(t[3]=e("h4",null,"Карточки со звуками",-1)),e("div",se,[(o(!0),i(m,null,f(r.shuffledSounds,(a,c)=>(o(),i("div",{key:c,class:"sound-card"},[e("audio",ae,[e("source",{src:a.audio,type:"audio/mpeg"},null,8,ne)]),e("button",{onClick:_=>n.selectSound(a)}," Нажмите для выбора ",8,ie)]))),128))])])])]))]),g(S,{to:"/tests",class:"btn btn-secondary"},{default:y(()=>t[6]||(t[6]=[I("Назад к тестам")])),_:1})])],64)}const le=v(H,[["render",re],["__scopeId","data-v-c8441873"]]);export{le as default};
